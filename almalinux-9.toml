name = "almalinux-9"
description = "AlmaLinux 9"
distro = "almalinux-92"
version = "0.0.0"
modules = []
groups = []

[[packages]]
name = "cloud-init"
version = "*"

[[packages]]
name = "firewalld"
version = "*"

[[packages]]
name = "ipa-client"
version = "*"

[[packages]]
name = "subscription-manager"
version = "*"

[[packages]]
name = "vim"
version = "*"

[[packages]]
name = "cri-o"
version = "*"

[[packages]]
name = "kubelet"
version = "*"

[[packages]]
name = "kubeadm"
version = "*"

[[packages]]
name = "kubectl"
version = "*"

[[containers]]
source = "registry.k8s.io/coredns/coredns:v1.10.1"

[[containers]]
source = "registry.k8s.io/etcd:3.5.9-0"

[[containers]]
source = "registry.k8s.io/kube-apiserver:v1.28.2"

[[containers]]
source = "registry.k8s.io/kube-controller-manager:v1.28.2"

[[containers]]
source = "registry.k8s.io/kube-proxy:v1.28.2"

[[containers]]
source = "registry.k8s.io/kube-scheduler:v1.28.2"

[[containers]]
source = "registry.k8s.io/pause:3.9"

[customizations.kernel]
append = "modules_load=overlay,br_netfilter"

[customizations]

[customizations.timezone]
timezone = "Europe/Zurich"

[customizations.firewall]
ports = ["6443:tcp", "10250:tcp"]

[customizations.firewall.services]
enabled = ["cockpit", "ssh"]

[customizations.services]
enabled = ["sshd", "cockpit.socket", "crio", "kubelet"]

[[customizations.files]]
path = "/etc/sysctl.d/99-x-local.conf"
mode = "0644"
user = "root"
group = "root"
data = """
# sysctl settings are defined through files in
# /usr/lib/sysctl.d/, /run/sysctl.d/, and /etc/sysctl.d/.
#
# Vendors settings live in /usr/lib/sysctl.d/.
# To override a whole file, create a new file with the same in
# /etc/sysctl.d/ and put new settings there. To override
# only specific settings, add a file with a lexically later
# name in /etc/sysctl.d/ and put new settings there.
#
# For more information, see sysctl.conf(5) and sysctl.d(5).
kernel.randomize_va_space = 2

net.ipv6.conf.all.accept_ra = 0
net.ipv6.conf.all.accept_redirects = 0
net.ipv6.conf.all.accept_source_route = 0
net.ipv6.conf.all.forwarding = 0
net.ipv6.conf.default.accept_ra = 0
net.ipv6.conf.default.accept_redirects = 0
net.ipv6.conf.default.accept_source_route = 0
net.bridge.bridge-nf-call-ip6tables = 1

net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.all.log_martians = 1
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.default.log_martians = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.default.secure_redirects = 0
net.ipv4.icmp_echo_ignore_broadcasts = 1
net.ipv4.icmp_ignore_bogus_error_responses = 1
net.ipv4.tcp_syncookies = 1
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0
net.ipv4.ip_forward = 1
net.bridge.bridge-nf-call-iptables = 1"""

[[customizations.sshkey]]
user = "root"
key = "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAvv0JHfOaqUR0XShL66xUw5lWQQSwoo8IdRigObgcPrWKc8BrYDjQmWGuyLG/Y14v0XLZ/xv6qyX6yRVLWJNm2PsO7g739KZWvIC49kMhfqjEm7hr2NHaQVNuAJlavE7JLt9WjRPY5GvTYAjnBB49rTATT+wPshNMlnI/cnf21Cn+0kbltB6q8lIeo/gDW8XYsTCPKvikSPAAFgUozljnwW7DNeFlag8e8pPAB1VFJOafwJPZ++jyUPFd0+gCOCk7pvfOlVST/r6Iplyw4K5KkcWhxWMCz5MvYkC9jUSmGjpfaQvbExordbeNr+zkvTGsj8XWVLWV0KK0LwBvVBDFOQ=="

[[customizations.user]]
name = "admin"
description = "Local Admin User"
password = "$6$t58wJBNUgBnRbPcz$OiTh3obvlTx4/bNyiYrItckqFMMEyrM88o.KjHqdWDK2lB3egQUguvVjIG6mbVSMqetumC8NXNGU..3tVTUfP/"
key = "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAvv0JHfOaqUR0XShL66xUw5lWQQSwoo8IdRigObgcPrWKc8BrYDjQmWGuyLG/Y14v0XLZ/xv6qyX6yRVLWJNm2PsO7g739KZWvIC49kMhfqjEm7hr2NHaQVNuAJlavE7JLt9WjRPY5GvTYAjnBB49rTATT+wPshNMlnI/cnf21Cn+0kbltB6q8lIeo/gDW8XYsTCPKvikSPAAFgUozljnwW7DNeFlag8e8pPAB1VFJOafwJPZ++jyUPFd0+gCOCk7pvfOlVST/r6Iplyw4K5KkcWhxWMCz5MvYkC9jUSmGjpfaQvbExordbeNr+zkvTGsj8XWVLWV0KK0LwBvVBDFOQ=="
home = "/home/admin/"
shell = "/usr/bin/bash"
groups = ["users", "wheel"]
uid = 1000

[customizations.openscap]
datastream = "/usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml"
profile_id = "xccdf_org.ssgproject.content_profile_cis"
tailoring = "/etc/osbuild-composer/oscap/xccdf_ch.hairmare.content_profile_cis_light.xml"
